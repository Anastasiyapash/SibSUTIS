;-----------------------------------------------------------
; Пример ввода строки с 3fh int 21h
;-----------------------------------------------------------

data	segment para public 'data'	; начало сегмента данных
                                        ; para - сегмент начинается по адресу
                                        ;         кратному 16
                                        ; public - объединять все сегменты с
                                        ;           одинаковым именем 'data'
message1	db	'Введите любую строку: $'
message2	db	'Вы ввели строку: $'
value	db	20 dup(0)       ;введённое значение
data	ends                            ; конец сегмента данных

stk	segment stack                   ; начало сегмента стека
	db	256 dup('?')
stk	ends                            ; конец сегмента стека

code	segment para public 'code'      ; начало сегмента кода
	assume	cs:code,ds:data;,ss:stk
smain	proc

	mov	ax,data        		; связываем регистр ds с сегментом
	mov	ds,ax                   ;	данных через регистр ax

	mov	ah,09h                  ; 09h - код функции для вывода строки,
                                        ;	которая заканчивается '$'
	mov	dx,offset message1  	; адрес начала строки
	int	21h                     ; вывод строки на экран

	mov	ah,3fh                  ; 3fh - код функции для ввода строки
	mov	bx,0                    ; дескриптор файла для клавиатуры
	mov	cx,20                   ; мах размер вводимой строки включая
					;	0Dh(13) и 0Ah(10)
	lea	dx,value                ; начальный адрес для вводимых данных
	int	21h                     ; вызов обработчика прерываний
push	ax                              ; сохранить размер введённой строки

	mov	ah,09h                  ; 09h - код функции для вывода строки
	mov	dx,offset message2  	; адрес начала строки
	int	21h                     ; вывод строки на экран

pop	ax                              ; восстановление значения регистра
					;	(размер введённой строки)
	lea	si,value                ; адрес значения введенной строки
	add	si,ax                   ; адрес конца строки
	sub	si,2
	mov	byte ptr[si],'$'        ; ограничитель конца строки для 09h

	mov	ah,09h                  ; 09h - код функции для вывода строки
	lea	dx,value                ; адрес начала строки
	int	21h                     ; вывод строки на экран

	mov	ax,4c00h                ; 4c00h - код функции для стандартного
                                        ;	 выхода
	int 21h                         ; стандартный выход

smain	endp
code	ends                            ; конец сегмента кода
end	smain
